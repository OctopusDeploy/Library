{
  "Id": "9e2fa6bc-0ce7-4dbe-b6f9-4d14d4877e42",
  "Name": "AWS - Deploy Lambda Function using IAM Role auth",
  "Description": "Deploys a Zip file to an AWS Lambda function using the IAM role configured on the machine.  

This step can perform variable substitution, however, the recommended approach to changing a lambda configuration per environment is to use [environment variables](https://docs.aws.amazon.com/lambda/latest/dg/configuration-envvars.html)  

This step uses the following AWS CLI commands to deploy the AWS Lambda.  You will be required to install the AWS CLI on your server/worker for this to work.  The AWS CLI is pre-installed on the [dynamic workers](https://octopus.com/docs/infrastructure/workers/dynamic-worker-pools) in Octopus Cloud as well as the provided docker containers for [Execution Containers](https://octopus.com/docs/deployment-process/execution-containers-for-workers).

- [create-function](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/create-function.html)
- [get-function](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/get-function.html)
- [publish-version](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/publish-version.html)
- [tag-resource](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/tag-resource.html)
- [untag-resource](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/untag-resource.html)
- [update-function-code](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/update-function-code.html)
- [update-function-configuration](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/update-function-configuration.html)

This step template is worker-friendly, you can pass in a package reference rather than having to reference a previous step that downloaded the package. This step requires **Octopus Deploy 2019.10.0** or higher.

## Output Variables

This step template sets the following output variables:

- `LambdaArn`: The ARN of the Lambda Function
- `PublishedVersion`: The most recent version published (only set when Publish is set to `Yes`).",
  "ActionType": "Octopus.AwsRunScript",
  "Version": 1,
  "CommunityActionTemplateId": null,
  "Packages": [
    {
      "Id": "8dbae499-5aa8-438e-a2fe-ae29fb8f0a39",
      "Name": "AWS.Lambda.Package",
      "PackageId": null,
      "FeedId": null,
      "AcquisitionLocation": "Server",
      "Properties": {
        "Extract": "True",
        "SelectionMode": "deferred",
        "PackageParameterName": "AWS.Lambda.Package",
        "Purpose": ""
      }
    }
  ],
  "Properties": {
    "Octopus.Action.Script.ScriptSource": "Inline",
    "Octopus.Action.Script.Syntax": "PowerShell",
    "Octopus.Action.Aws.AssumeRole": "False",
    "Octopus.Action.AwsAccount.UseInstanceRole": "True",
    "Octopus.Action.Aws.Region": "#{AWS.Lambda.Region}",
    "Octopus.Action.Script.ScriptBody": "$functionName = $OctopusParameters[\"AWS.Lambda.FunctionName\"] 
$functionRole = $OctopusParameters[\"AWS.Lambda.FunctionRole\"]
$functionRunTime = $OctopusParameters[\"AWS.Lambda.Runtime\"]
$functionHandler = $OctopusParameters[\"AWS.Lambda.FunctionHandler\"]
$functionMemorySize = $OctopusParameters[\"AWS.Lambda.MemorySize\"]
$functionDescription = $OctopusParameters[\"AWS.Lambda.Description\"]
$functionVPCSubnetId = $OctopusParameters[\"AWS.Lambda.VPCSubnetIds\"]
$functionVPCSecurityGroupId = $OctopusParameters[\"AWS.Lambda.VPCSecurityGroupIds\"]
$functionEnvironmentVariables = $OctopusParameters[\"AWS.Lambda.EnvironmentVariables\"]
$functionEnvironmentVariablesKey = $OctopusParameters[\"AWS.Lambda.EnvironmentVariablesKey\"]
$functionTimeout = $OctopusParameters[\"AWS.Lambda.FunctionTimeout\"]
$functionTags = $OctopusParameters[\"AWS.Lambda.Tags\"]
$functionFileSystemConfig = $OctopusParameters[\"AWS.Lambda.FileSystemConfig\"]
$functionDeadLetterConfig = $OctopusParameters[\"AWS.Lambda.DeadLetterConfig\"]
$functionTracingConfig = $OctopusParameters[\"AWS.Lambda.TracingConfig\"]
$functionVersionNumber = $OctopusParameters[\"Octopus.Action.Package[AWS.Lambda.Package].PackageVersion\"]
$functionPublishOption = $OctopusParameters[\"AWS.Lambda.Publish\"]

$functionReleaseNumber = $OctopusParameters[\"Octopus.Release.Number\"]
$functionRunbookRun = $OctopusParameters[\"Octopus.RunbookRun.Id\"]
$stepName = $OctopusParameters[\"Octopus.Step.Name\"]

$regionName = $OctopusParameters[\"AWS.Lambda.Region\"]
$newArchiveFileName = \"$($OctopusParameters[\"Octopus.Action.Package[AWS.Lambda.Package].ExtractedPath\"])/$($OctopusParameters[\"Octopus.Action.Package[AWS.Lambda.Package].PackageId\"]).$($OctopusParameters[\"Octopus.Action.Package[AWS.Lambda.Package].PackageVersion\"]).zip\"

if ([string]::IsNullOrWhiteSpace($functionName))
{
\tWrite-Error \"The parameter Function Name is required.\"
    Exit 1
}

if ([string]::IsNullOrWhiteSpace($functionRole))
{
\tWrite-Error \"The parameter Role is required.\"
    Exit 1
}

if ([string]::IsNullOrWhiteSpace($functionRunTime))
{
\tWrite-Error \"The parameter Run Time is required.\"
    Exit 1
}

if ([string]::IsNullOrWhiteSpace($functionHandler))
{
\tWrite-Error \"The parameter Handler is required.\"
    Exit 1
}

if ([string]::IsNullOrWhiteSpace($functionPublishOption))
{
\tWrite-Error \"The parameter Publish is required.\"
    Exit 1
}

if ([string]::IsNullOrWhiteSpace($functionReleaseNumber) -eq $false)
{
    $deployVersionTag = \"Octopus-Release=$functionReleaseNumber\"
}
else
{
\t$deployVersionTag = \"Octopus-Runbook-Run=$functionRunbookRun\"
}

Write-Host \"Function Name: $functionName\"
Write-Host \"Function Role: $functionRole\"
Write-Host \"Function Runtime: $functionRunTime\"
Write-Host \"Function Handler: $functionHandler\"
Write-Host \"Function Memory Size: $functionMemorySize\"
Write-Host \"Function Description: $functionDescription\"
Write-Host \"Function Subnet Ids: $functionVPCSubnetId\"
Write-Host \"Function Security Group Ids: $functionVPCSecurityGroupId\"
Write-Host \"Function Environment Variables: $functionEnvironmentVariables\"
Write-Host \"Function Environment Variables Key: $functionEnvironmentVariablesKey\"
Write-Host \"Function Timeout: $functionTimeout\"
Write-Host \"Function Tags: $functionTags\"
Write-Host \"Function File System Config: $functionFileSystemConfig\"
Write-Host \"Function Dead Letter Config: $functionDeadLetterConfig\"
Write-Host \"Function Tracing Config: $functionTracingConfig\"
Write-Host \"Function file path: fileb://$newArchiveFileName\"
Write-Host \"Function Publish: $functionPublishOption\"

Write-Host \"Re-packaging archive ...\"

# Repackage the files into a zip file
Compress-Archive -Path \"$($OctopusParameters[\"Octopus.Action.Package[AWS.Lambda.Package].ExtractedPath\"])/*\" -DestinationPath $newArchiveFileName

Write-Host \"Attempting to find the function $functionName in the region $regionName\"
$hasExistingFunction = $true

try
{
    $existingFunction = aws lambda get-function --function-name \"$functionName\" 2> $null
    
    Write-Host \"The exit code from the lookup was $LASTEXITCODE\"
    if ($LASTEXITCODE -eq 255 -or $LASTEXITCODE -eq 254)
    {
    \t$hasExistingFunction = $false
    }   
    
    $existingFunction = $existingFunction | ConvertFrom-Json
}
catch
{
\tWrite-Host \"The function was not found\"
\t$hasExistingFunction = $false
}

Write-Host \"Existing functions: $hasExistingFunction\"
Write-Host $existingFunction

$aliasInformation = $null
if ($hasExistingFunction -eq $false)
{
\tWrite-Highlight \"Creating $functionName in $regionName\"    
\t$functionInformation = aws lambda create-function --function-name \"$functionName\" --zip-file fileb://$newArchiveFileName --handler $functionHandler --runtime $functionRuntime --role $functionRole --memory-size $functionMemorySize
}
else
{
\tWrite-Highlight \"Updating the $functionName code\"
    $updatedConfig = aws lambda update-function-code --function-name \"$functionName\" --zip-file fileb://$newArchiveFileName
    
    Write-Highlight \"Waiting for update to complete ...\"
    aws lambda wait function-updated --function-name \"$functionName\"
    
    Write-Highlight \"Updating the $functionName base configuration\"    
    $functionInformation = aws lambda update-function-configuration --function-name \"$functionName\" --role $functionRole --handler $functionHandler --runtime $functionRuntime --memory-size $functionMemorySize
    
    Write-Highlight \"Waiting for base configuration update to complete ...\"
    aws lambda wait function-updated --function-name \"$functionName\"
}

$functionInformation = $functionInformation | ConvertFrom-JSON
$functionArn = $functionInformation.FunctionArn

Write-Host \"Function ARN: $functionArn\"

if ([string]::IsNullOrWhiteSpace($functionEnvironmentVariables) -eq $false)
{
\tWrite-Highlight \"Environment variables specified, updating environment variables configuration for $functionName\"
\t$environmentVariables = \"Variables={$functionEnvironmentVariables}\"
    
    if ([string]::IsNullOrWhiteSpace($functionEnvironmentVariablesKey) -eq $true)
    {
    \t$updatedConfig = aws lambda update-function-configuration --function-name \"$functionArn\" --environment \"$environmentVariables\"
    }
    else
    {
    \t$updatedConfig = aws lambda update-function-configuration --function-name \"$functionArn\" --environment \"$environmentVariables\" --kms-key-arn \"$functionEnvironmentVariablesKey\"
    }
    
    Write-Highlight \"Waiting for environment variable update to complete ...\"
    aws lambda wait function-updated --function-name \"$functionName\"
}

if ([string]::IsNullOrWhiteSpace($functionTimeout) -eq $false)
{
\tWrite-Highlight \"Timeout specified, updating timeout configuration for $functionName\"
\t$updatedConfig = aws lambda update-function-configuration --function-name \"$functionArn\" --timeout \"$functionTimeout\"
    
    Write-Highlight \"Waiting for timeout upate to complete ...\"
    aws lambda wait function-updated --function-name \"$functionName\"
}

if ([string]::IsNullOrWhiteSpace($functionTags) -eq $false)
{
\tWrite-Highlight \"Tags specified, updating tags configuration for $functionName\"
\t$updatedConfig = aws lambda tag-resource --resource \"$functionArn\" --tags \"$functionTags\"
}

if ([string]::IsNullOrWhiteSpace($deployVersionTag) -eq $false)
{
\tWrite-Highlight \"Deploy version tag found with value of $deployVersionTag, updating tags configuration for $functionName\"
    aws lambda untag-resource --resource \"$functionArn\" --tag-keys \"Octopus-Release\" \"Octopus-Runbook-Run\"
\t$updatedConfig = aws lambda tag-resource --resource \"$functionArn\" --tags \"$deployVersionTag\"
}

if ([string]::IsNullOrWhiteSpace($functionVPCSubnetId) -eq $false -and [string]::IsNullOrWhiteSpace($functionVPCSecurityGroupId) -eq $false)
{
\tWrite-Highlight \"VPC subnets and security group specified, updating vpc configuration for $functionName\"
\t$vpcConfig = \"SubnetIds=$functionVPCSubnetId,SecurityGroupIds=$functionVPCSecurityGroupId\"
\t$updatedConfig = aws lambda update-function-configuration --function-name \"$functionArn\" --vpc-config \"$vpcConfig\"
    
    Write-Highlight \"Waiting for vpc configuration to complete ...\"
    aws lambda wait function-updated --function-name \"$functionName\"
}

if ([string]::IsNullOrWhiteSpace($functionDescription) -eq $false)
{
\tWrite-Highlight \"Description specified, updating description configuration for $functionName\"
\t$updatedConfig = aws lambda update-function-configuration --function-name \"$functionArn\" --description \"$functionDescription\"
    
    Write-Highlight \"Waiting for description configuration ...\"
    aws lambda wait function-updated --function-name \"$functionName\"
}

if ([string]::IsNullOrWhiteSpace($functionFileSystemConfig) -eq $false)
{
\tWrite-Highlight \"File System Config specified, updating file system configuration for $functionName\"
\t$updatedConfig = aws lambda update-function-configuration --function-name \"$functionArn\" --file-system-configs \"$functionFileSystemConfig\"\t
    
    Write-Highlight \"Wating for file system configuration update to complete ...\"
    aws lambda wait function-updated --function-name \"$functionName\"
}

if ([string]::IsNullOrWhiteSpace($functionDeadLetterConfig) -eq $false)
{
\tWrite-Highlight \"Dead Letter specified, updating dead letter configuration for $functionName\"
\t$updatedConfig = aws lambda update-function-configuration --function-name \"$functionArn\" --dead-letter-config \"$functionDeadLetterConfig\"\t
    
    Write-Highlight \"Waitng for Dead Letter configuration update to complete ...\"
    aws lambda wait function-updated --function-name \"$functionName\"
}

if ([string]::IsNullOrWhiteSpace($functionTracingConfig) -eq $false)
{
\tWrite-Highlight \"Tracing config specified, updating tracing configuration for $functionName\"
\t$updatedConfig = aws lambda update-function-configuration --function-name \"$functionArn\" --tracing-config \"$functionTracingConfig\"\t
    
    Write-Highlight \"Waiting for tracing configuration to complete ...\"
    aws lambda wait function-updated --function-name \"$functionName\"
}

Write-Host $updatedConfig | ConvertFrom-JSON

if ($functionPublishOption -eq \"Yes\")
{
\tWrite-Highlight \"Publishing the function with the description $functionVersionNumber to create a snapshot of the current code and configuration of this function in AWS.\"
\t$publishedVersion = aws lambda publish-version --function-name \"$functionArn\" --description \"$functionVersionNumber\"
    
    $publishedVersion = $publishedVersion | ConvertFrom-JSON
    
    Write-Highlight \"Setting the output variable 'Octopus.Action[$($stepName)].Output.PublishedVersion' to $($publishedVersion.Version)\"
    Set-OctopusVariable -name \"PublishedVersion\" -value \"$($publishedVersion.Version)\"    
}

Write-Highlight \"Setting the output variable 'Octopus.Action[$($stepName)].Output.LambdaArn' to $functionArn\"
Set-OctopusVariable -name \"LambdaArn\" -value \"$functionArn\"

Write-Highlight \"AWS Lambda $functionName successfully deployed.\"",
    "OctopusUseBundledTooling": "False",
    "Octopus.Action.EnabledFeatures": "Octopus.Features.JsonConfigurationVariables,Octopus.Features.SubstituteInFiles",
    "Octopus.Action.Package.JsonConfigurationVariablesTargets": "#{AWS.Lambda.StructuredConfigurationVariables}",
    "Octopus.Action.SubstituteInFiles.TargetFiles": "#{AWS.Lambda.SubstituteVariablesinTemplates}"
  },
  "Parameters": [
    {
      "Id": "1575a1fe-24df-4953-a27b-aec5d741245a",
      "Name": "AWS.Lambda.FunctionName",
      "Label": "Function Name",
      "HelpText": "Required.

The name of the function to create or update.  See [documentation](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/create-function.html#options)

Examples:
- Function name - my-function .
- Function ARN - arn:aws:lambda:us-west-2:123456789012:function:my-function .
- Partial ARN - 123456789012:function:my-function .

The length constraint applies only to the full ARN. If you specify only the function name, it is limited to 64 characters in length.
",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "e1a04b5b-cd19-43cb-a8f3-925817d73272",
      "Name": "AWS.Lambda.Region",
      "Label": "Region",
      "HelpText": "Required.

The region where the function will live.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "Select",
        "Octopus.SelectOptions": "us-east-2|US East (Ohio)
us-east-1|US East (N. Virginia)
us-west-1|US West (N. California)
us-west-2|US West (Oregon)
af-south-1|Africa (Cape Town)
ap-east-1|Asia Pacific (Hong Kong)
ap-south-1|Asia Pacific (Mumbai)
ap-northeast-3|Asia Pacific (Osaka-Local)
ap-northeast-2|Asia Pacific (Seoul)
ap-southeast-1|Asia Pacific (Singapore)
ap-southeast-2|Asia Pacific (Sydney)
ap-northeast-1|Asia Pacific (Tokyo)
ca-central-1|Canada (Central)
eu-central-1|Europe (Frankfurt)
eu-west-1|Europe (Ireland)
eu-west-2|Europe (London)
eu-south-1|Europe (Milan)
eu-west-3|Europe (Paris)
eu-north-1|Europe (Stockholm)
me-south-1|Middle East (Bahrain)
sa-east-1|South America (São Paulo)"
      }
    },
    {
      "Id": "dd56868a-019f-4f3b-8231-72b8cce0d862",
      "Name": "AWS.Lambda.Package",
      "Label": "Package",
      "HelpText": "Required.

The package containing the code you wish to deploy to the AWS Lambda function.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "Package"
      }
    },
    {
      "Id": "15353fc5-0d45-40f7-a6ec-803371aa2fa9",
      "Name": "AWS.Lambda.FunctionRole",
      "Label": "Function Role",
      "HelpText": "Required.

The Amazon Resource Name (ARN) of the function’s execution role.  This role must exist prior to this step is run.  See [documentation](https://docs.aws.amazon.com/lambda/latest/dg/lambda-intro-execution-role.html) for more detail on creating an execution role.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "6bb03f9d-5ed6-4e7d-8cd8-71620cd81281",
      "Name": "AWS.Lambda.Runtime",
      "Label": "Runtime",
      "HelpText": "Required.

The runtime of the AWS Lambda.  See [documentation](https://awscli.amazonaws.com/v2/documentation/api/latest/reference/lambda/create-function.html#options) for more details on what runtimes are supported.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "Select",
        "Octopus.SelectOptions": "nodejs|nodejs
nodejs4.3|nodejs4.3
nodejs4.3-edge|nodejs4.3-edge
nodejs6.10|nodejs6.10
nodejs8.10|nodejs8.10
nodejs10.x|nodejs10.x
nodejs12.x|nodejs12.x
nodejs14.x|nodejs14.x
java8|java8
java8.al2|java8.al2
java11|java11
python2.7|python2.7
python3.6|python3.6
python3.7|python3.7
python3.8|python3.8
python3.9|python3.9
dotnetcore1.0|dotnetcore1.0
dotnetcore2.0|dotnetcore2.0
dotnetcore2.1|dotnetcore2.1
dotnetcore3.1|dotnetcore3.1
dotnet6|dotnet6
nodejs4.3-edge|nodejs4.3-edge
go1.x|go1.x
ruby2.5|ruby2.5
ruby2.7|ruby2.7
provided|provided
provided.al2|provided.al2"
      }
    },
    {
      "Id": "385948fb-d456-415b-ab33-77896e53823b",
      "Name": "AWS.Lambda.FunctionHandler",
      "Label": "Handler",
      "HelpText": "Required.

The name of the method within your code that Lambda calls to execute your function. The format includes the file name. It can also include namespaces and other qualifiers, depending on the runtime. For more information, see [Programming Model](https://docs.aws.amazon.com/lambda/latest/dg/gettingstarted-features.html)",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "de6cb1c3-1906-4f01-895e-634aad21540c",
      "Name": "AWS.Lambda.MemorySize",
      "Label": "Memory Size",
      "HelpText": "Required.

The amount of memory that your function has access to. Increasing the function’s memory also increases its CPU allocation. The default value is 128 MB. The value must be a multiple of 64 MB.",
      "DefaultValue": "128",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "7a225558-f530-407c-90d5-419dbd3c9b8f",
      "Name": "AWS.Lambda.Description",
      "Label": "Description",
      "HelpText": "Optional.

A description of the function.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "f0661cd1-6df2-4320-a41f-e8e7076a7518",
      "Name": "AWS.Lambda.VPCSubnetIds",
      "Label": "VPC Subnet Ids",
      "HelpText": "Optional.

Format: `SubnetId1,SubnetId2`

For network connectivity to AWS resources in a VPC, specify a list of security groups and subnets in the VPC. When you connect a function to a VPC, it can only access resources and the internet through that VPC. For more information, see [VPC Settings](https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html).",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "92eb428e-6837-4c78-a7ce-a4d43fb3955b",
      "Name": "AWS.Lambda.VPCSecurityGroupIds",
      "Label": "VPC Security Group Ids",
      "HelpText": "Optional.

Format: `SecurityGroupId1,SecurityGroupId2`

For network connectivity to AWS resources in a VPC, specify a list of security groups and subnets in the VPC. When you connect a function to a VPC, it can only access resources and the internet through that VPC. For more information, see [VPC Settings](https://docs.aws.amazon.com/lambda/latest/dg/configuration-vpc.html).",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "312fabde-f65d-49aa-99ab-c4eb41a5d9bb",
      "Name": "AWS.Lambda.EnvironmentVariables",
      "Label": "Environment Variables",
      "HelpText": "Optional.

Format: `KeyName1=string,KeyName2=string`

Environment variables that are accessible from function code during execution.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "f38bc9ee-c221-4f41-b344-b78d29b3f1bc",
      "Name": "AWS.Lambda.EnvironmentVariablesKey",
      "Label": "Environment Variables Encryption Key",
      "HelpText": "Optional.

The ARN of the AWS Key Management Service (AWS KMS) key that’s used to encrypt your function’s environment variables. If it’s not provided, AWS Lambda uses a default service key.
",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "e3432e86-c5c9-46ca-8bef-5f247938b285",
      "Name": "AWS.Lambda.FunctionTimeout",
      "Label": "Timeout",
      "HelpText": "Optional.

The amount of time that Lambda allows a function to run before stopping it. The default is 3 seconds. The maximum allowed value is 900 seconds.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "2b6e7aa2-512e-44e4-aad9-d16280752714",
      "Name": "AWS.Lambda.Tags",
      "Label": "Tags",
      "HelpText": "Optional.

Format: `KeyName1=string,KeyName2=string`

A list of tags to apply to the function.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "a69663ca-02fa-4d1d-abd9-0f554fd78013",
      "Name": "AWS.Lambda.FileSystemConfig",
      "Label": "File System Config",
      "HelpText": "Optional.

Format: `Arn=string,LocalMountPath=string`

Connection settings for an Amazon EFS file system.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "17ff862b-2d83-4819-a5b5-6bae7c45b71a",
      "Name": "AWS.Lambda.TracingConfig",
      "Label": "Tracing Config",
      "HelpText": "Optional.

Format: `Mode=string`

Set Mode to Active to sample and trace a subset of incoming requests with AWS X-Ray.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "558e6e77-d9e4-483d-8f43-c1059e67cc60",
      "Name": "AWS.Lambda.DeadLetterConfig",
      "Label": "Dead Letter Config",
      "HelpText": "Optional.

Format: `TargetArn=string`

A dead letter queue configuration that specifies the queue or topic where Lambda sends asynchronous events when they fail processing. For more information, see [Dead Letter Queues](https://docs.aws.amazon.com/lambda/latest/dg/invocation-async.html#dlq).
",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "5ad9e9f4-48c3-4c3f-a34d-a0f14af4318a",
      "Name": "AWS.Lambda.Publish",
      "Label": "Publish",
      "HelpText": "Required.

Creates a [version](https://docs.aws.amazon.com/lambda/latest/dg/versioning-aliases.html) from the current code and configuration of a function. Use versions to create a snapshot of your function code and configuration that doesn’t change.

**Important**: Lambda doesn’t publish a version if the function’s configuration and code haven’t changed since the last version. Use UpdateFunctionCode or UpdateFunctionConfiguration to update the function before publishing a version.",
      "DefaultValue": "Yes",
      "DisplaySettings": {
        "Octopus.ControlType": "Select",
        "Octopus.SelectOptions": "Yes|Yes
No|No"
      }
    },
    {
      "Id": "50051025-3ec9-43b0-a752-b8b08d0d159e",
      "Name": "AWS.Lambda.StructuredConfigurationVariables",
      "Label": "Structured Configuration Variables",
      "HelpText": "To ensure you get the correct path, preface all entries with
`#{Octopus.Action.Package[AWS.Lambda.Package].ExtractedPath}/`

Target files need to be new line seperated, relative to the package contents. Extended wildcard syntax is supported. E.g., appsettings.json, Config\\*.xml, **\\specific-folder\\*.yaml. Learn more about Structured Configuration Variables and view examples.

Note: To avoid unnecessary warnings, the default value is a blank space.",
      "DefaultValue": " ",
      "DisplaySettings": {
        "Octopus.ControlType": "MultiLineText"
      }
    },
    {
      "Id": "8363b78f-f808-4b73-bee1-7b60d9186abf",
      "Name": "AWS.Lambda.SubstituteVariablesinTemplates",
      "Label": "Substitute Variables in Templates",
      "HelpText": "To ensure you get the correct path, preface all entries with
`#{Octopus.Action.Package[AWS.Lambda.Package].ExtractedPath}/`

A newline-separated list of file names to transform, relative to the package contents. Extended wildcard syntax is supported. E.g., Notes.txt, Config\\*.json, **\\specific-folder\\*.config.
This field supports extended template syntax. Conditional if and unless:
`#{if MyVar}...#{/if}`
Iteration over variable sets or comma-separated values with each:
`#{each mv in MyVar}...#{mv}...#{/each}`

Note: To avoid unnecessary warnings, the default value is a blank space.",
      "DefaultValue": " ",
      "DisplaySettings": {
        "Octopus.ControlType": "MultiLineText"
      }
    }
  ],
  "StepPackageId": "Octopus.AwsRunScript",
  "$Meta": {
    "ExportedAt": "2023-06-27T18:05:45.154Z",
    "OctopusVersion": "2023.3.4135",
    "Type": "ActionTemplate"
  },
  "LastModifiedBy": "twerthi",
  "Category": "aws"
}
