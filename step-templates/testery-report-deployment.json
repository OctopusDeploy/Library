{
  "Id": "8a3cf065-d5b5-4f9e-b916-73aac4ce95f6",
  "Name": "Testery - Report Deployment",
  "Description": "Report a deployment to a Testery project",
  "ActionType": "Octopus.Script",
  "Version": 5,
  "CommunityActionTemplateId": null,
  "Packages": [],
  "GitDependencies": [],
  "Properties": {
    "Octopus.Action.RunOnServer": "true",
    "Octopus.Action.Script.ScriptSource": "Inline",
    "Octopus.Action.Script.Syntax": "Bash",
    "Octopus.Action.Script.ScriptBody": "set -e\n\nTOKEN=$(get_octopusvariable \"TesteryToken\")\nPROJECT_KEY=$(get_octopusvariable \"TesteryProjectKey\")\nENVIRONMENT_KEY=$(get_octopusvariable \"TesteryEnvironmentKey\")\nBUILD_ID=$(get_octopusvariable \"TesteryBuildId\")\nOUTPUT=$(get_octopusvariable \"TesteryOutput\")\nGIT_REF=$(get_octopusvariable \"TesteryGitCommit?\")\nGIT_BRANCH=$(get_octopusvariable \"TesteryGitBranch?\")\nGIT_OWNER=$(get_octopusvariable \"TesteryGitOwner?\")\nGIT_PROVIDER=$(get_octopusvariable \"TesteryGitProvider?\")\nWAIT_FOR_RESULTS=$(get_octopusvariable \"TesteryWaitForResults?\")\nFAIL_ON_FAILURE=$(get_octopusvariable \"TesteryFailOnFailure?\")\nSKIP_VSC_UPDATE=$(get_octopusvariable \"TesterySkipVCSUpdates?\")\nSTATUS_NAME=$(get_octopusvariable \"TesteryStatusName?\")\n\nif [ \"$GIT_PROVIDER\" = \"None\" ] ; then\n    GIT_PROVIDER=\nfi\n\nexport PATH=\"$HOME/.local/bin:$PATH\"\npip install --user testery --upgrade\n\ntestery create-test-run --token $TOKEN \\\n  --project-key $PROJECT_KEY \\\n  --environment-key $ENVIRONMENT_KEY \\\n  --build-id $BUILD_ID \\\n  --output $OUTPUT \\\n  ${GIT_REF:+ --git-ref \"$GIT_REF\"} \\\n  ${GIT_BRANCH:+ --git-branch \"$GIT_BRANCH\"} \\\n  ${GIT_OWNER:+ --git-owner \"$GIT_OWNER\"} \\\n  ${GIT_PROVIDER:+ --git-provider \"$GIT_PROVIDER\"} \\\n  ${STATUS_NAME:+ --status-name \"$STATUS_NAME\"} \\\n  ${WAIT_FOR_RESULTS:+ --wait-for-results} \\\n  ${FAIL_ON_FAILURE:+ --fail-on-failure} \\\n  ${SKIP_VSC_UPDATE:+ --skip-vcs-updates}"
  },
  "Parameters": [
    {
      "Id": "f01f917a-b2c8-4038-be1c-b2355639f57e",
      "Name": "TesteryToken",
      "Label": "Token",
      "HelpText": "Your Testery API token (found in Testery -> Settings -> Integrations -> Show API Token)",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "Sensitive"
      }
    },
    {
      "Id": "4873b6f2-694a-463f-928a-9845b044bc8b",
      "Name": "TesteryProjectKey",
      "Label": "Project Key",
      "HelpText": "The key of the test project in the Testery platform.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "811352ba-a3e4-4092-99c2-b48499b9a880",
      "Name": "TesteryEnvironmentKey",
      "Label": "Environment Key",
      "HelpText": "The key of the environment defined in Testery where you want the tests to run.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "7a6aa01f-13a1-4fa7-a681-7f0acda63932",
      "Name": "TesteryBuildId",
      "Label": "Build Id",
      "HelpText": "The build ID from your CI/CD. If you have uploaded any test artifacts from your CI/CD, this build id should match the build id used when uploading artifacts.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "bf135a1b-d58f-4e6b-ab9c-fe03b52ed09d",
      "Name": "TesteryOutput",
      "Label": "Output",
      "HelpText": "The format for outputting results.",
      "DefaultValue": "pretty",
      "DisplaySettings": {
        "Octopus.ControlType": "Select",
        "Octopus.SelectOptions": "json|Json\npretty|Pretty\nteamcity|TeamCity"
      }
    },
    {
      "Id": "09ed4f34-d381-4f85-8869-c52264694b7c",
      "Name": "TesteryFailOnFailure?",
      "Label": "Fail On Failure?",
      "HelpText": "When checked, the Octopus deployment will fail if any of the test runs associated with the deployment fail. When unchecked, the Octopus deployment will continue even if there are test failures.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "Checkbox"
      }
    },
    {
      "Id": "2266652a-258d-447f-aebf-14e9575d6b9d",
      "Name": "TesteryWaitForResults?",
      "Label": "Wait For Results?",
      "HelpText": "When checked, Octopus Deploy will wait for the any test runs associated with the deployment to complete before proceeding. This is useful for making sure deployments don't run on environments/tenants with an active test run.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "Checkbox"
      }
    },
    {
      "Id": "f96b7529-7ced-4265-8176-972ec30b9bba",
      "Name": "TesteryGitProvider?",
      "Label": "Git Provider?",
      "HelpText": "The Git provider used for the repository that is being deployed.",
      "DefaultValue": "None",
      "DisplaySettings": {
        "Octopus.ControlType": "Select",
        "Octopus.SelectOptions": "None|None\nGitHub|GitHub\nBitBucket|BitBucket\nGitLab|GitLab"
      }
    },
    {
      "Id": "ce589aa1-4747-4b51-87fb-5734ab676dd5",
      "Name": "TesteryGitCommit?",
      "Label": "Git Commit?",
      "HelpText": "The Git commit that was deployed.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "4a30530e-3a71-4a22-af35-57219da67cdf",
      "Name": "TesteryGitOwner?",
      "Label": "Git Owner?",
      "HelpText": "The organization owner in Git for the repository that is being deployed.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "59f6ad53-a42d-4e0e-96e4-aa422889cdbf",
      "Name": "TesteryGitRepo?",
      "Label": "Git Repo?",
      "HelpText": "The repository name that is being deployed.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "ecd2de3e-bed5-4028-8fbe-b71f16e68ac4",
      "Name": "TesteryGitBranch?",
      "Label": "Git Branch?",
      "HelpText": "The Git branch the deploy came from.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "e24fd5af-d8d3-4cec-8e33-f3ff3b043e14",
      "Name": "TesteryStatusName?",
      "Label": "Status Name?",
      "HelpText": "The name you want to use on the Git status, as plain text.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "SingleLineText"
      }
    },
    {
      "Id": "7c73a878-0033-43d0-b5e6-cab98b0fb549",
      "Name": "TesterySkipVCSUpdates?",
      "Label": "SkipVCSUpdates?",
      "HelpText": "Check this if you do not want to submit status updates to Version Control.",
      "DefaultValue": "",
      "DisplaySettings": {
        "Octopus.ControlType": "Checkbox"
      }
    }
  ],
  "StepPackageId": "Octopus.Script",
  "$Meta": {
    "ExportedAt": "2026-02-13T21:28:53.679Z",
    "OctopusVersion": "2026.1.7285",
    "Type": "ActionTemplate"
  },
  "LastModifiedBy": "wgunn-testery",
  "Category": "testery"
}
