{
    "Id": "ac0dee2d-dcbe-42aa-96c6-bb6c644183b4",
    "Name": "Firebase - Deploy",
    "Description": "Deploys the contents of a package to a Firebase project using the [Firebase CLI deploy command](https://firebase.google.com/docs/cli/#deployment).",
    "ActionType": "Octopus.Script",
    "Version": 2,
    "CommunityActionTemplateId": null,
    "Packages": [
        {
            "Id": "343306b7-6997-429f-9ed5-4214ca4d32ac",
            "Name": "FirebaseDeploy.Package",
            "PackageId": null,
            "FeedId": null,
            "AcquisitionLocation": "Server",
            "Properties": {
                "Extract": "True",
                "SelectionMode": "deferred",
                "PackageParameterName": "FirebaseDeploy.Package"
            }
        }
    ],
    "Properties": {
        "Octopus.Action.Script.ScriptSource": "Inline",
        "Octopus.Action.Script.Syntax": "Bash",
        "Octopus.Action.Script.ScriptBody": "packagePath=$(get_octopusvariable \"Octopus.Action.Package[FirebaseDeploy.Package].ExtractedPath\")
token=$(get_octopusvariable \"FirebaseDeploy.CIToken\")
public=$(get_octopusvariable \"FirebaseDeploy.Public\")
message=$(get_octopusvariable \"FirebaseDeploy.Message\")
force=$(get_octopusvariable \"FirebaseDeploy.Force\")
only=$(get_octopusvariable \"FirebaseDeploy.Only\")
except=$(get_octopusvariable \"FirebaseDeploy.Except\")
printCommand=$(get_octopusvariable \"FirebaseDeploy.PrintCommand\")
firebasePath=$(get_octopusvariable \"FirebaseDeploy.FirebasePath\")

if [ ! -z \"$firebasePath\" ] ; then
   \tPATH=$firebasePath:$PATH
fi

if [ \"$force\" = \"True\" ] ; then
    force=true
else
    force=
fi

if [ \"$printCommand\" = \"True\" ] ; then
    set -x
fi

cd $packagePath

firebase deploy ${public:+ -p \"$public\"} ${message:+ -m \"$message\"} ${force:+ -f} ${only:+ --only \"$only\"} ${except:+ --except \"$except\"} --token $token"
    },
    "Parameters": [
        {
            "Id": "55ddf9fd-bf2f-4148-912b-bc599c5f6ec6",
            "Name": "FirebaseDeploy.Package",
            "Label": "Package",
            "HelpText": "The package containing the Firebase project being deployed.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "Package"
            }
        },
        {
            "Id": "46874eaf-7632-40d1-bd46-4627bd0f2d0c",
            "Name": "FirebaseDeploy.FirebasePath",
            "Label": "Firebase Path",
            "HelpText": "The path to the directory containing the Firebase CLI, if not in $PATH.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "c982c1f3-a91e-4dd4-89a6-db5d99b08347",
            "Name": "FirebaseDeploy.CIToken",
            "Label": "CI Token",
            "HelpText": "A CI token generated by the [Firebase CLI](https://firebase.google.com/docs/cli/#cli-ci-systems)",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "Sensitive"
            }
        },
        {
            "Id": "56628161-6b99-4ca3-9c4a-1234117a0018",
            "Name": "FirebaseDeploy.Public",
            "Label": "Public Path",
            "HelpText": "Override the Hosting public directory specified in firebase.json.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "e7c41fcb-dd74-4ba2-9671-fa7313d632b8",
            "Name": "FirebaseDeploy.Message",
            "Label": "Message",
            "HelpText": "An optional message describing this deploy.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "6a88a428-a538-4292-b6ee-b843c28887f3",
            "Name": "FirebaseDeploy.Force",
            "Label": "Force?",
            "HelpText": "Delete Cloud Functions missing from the current working directory without confirmation.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "Checkbox"
            }
        },
        {
            "Id": "c0debcc3-6708-4d3c-977b-880811b48594",
            "Name": "FirebaseDeploy.Only",
            "Label": "Only Targets",
            "HelpText": "Only deploy to specified, comma-separated targets (e.g. \"hosting,storage\"). For functions, can specify filters with colons to scope function deploys to only those functions (e.g. \"--only functions:func1,functions:func2\"). When filtering based on export groups (the exported module object keys), use dots to specify group names (e.g. \"--only functions:group1.subgroup1,functions:group2)\".",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "e62a6b0f-6331-4a63-a908-c759798ccd1c",
            "Name": "FirebaseDeploy.Except",
            "Label": "Except Targets",
            "HelpText": "Deploy to all targets except specified (e.g. \"database\").",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "e2e0ac14-e5e9-4b3c-bdc1-b1da3d7be184",
            "Name": "FirebaseDeploy.PrintCommand",
            "Label": "Print Command?",
            "HelpText": "Prints the command in the logs using `set -x`. This will cause a warning when the step runs.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "Checkbox"
            }
        }
    ],
    "$Meta": {
        "ExportedAt": "2020-06-08T19:44:37.662Z",
        "OctopusVersion": "2020.2.11",
        "Type": "ActionTemplate"
    },
    "LastModifiedBy": "ryanrousseau",
    "Category": "firebase"
}
