{
    "Id": "acbb0a58-e176-4309-8a1f-a0296214d4a4",
    "Name": "GCP - gcloud run deploy (bash)",
    "Description": "[gcloud run deploy](https://cloud.google.com/sdk/gcloud/reference/run/deploy) - deploy a container to Cloud Run",
    "ActionType": "Octopus.GoogleCloudScripting",
    "Author": "ryanrousseau",
    "Version": 1,
    "Packages": [
        {
            "Id": "42ba13b1-0b02-48e1-a880-49f2b00ef1a5",
            "Name": "GCloudRunDeploy.Container",
            "PackageId": null,
            "FeedId": null,
            "AcquisitionLocation": "NotAcquired",
            "Properties": {
                "Extract": "True",
                "SelectionMode": "deferred",
                "PackageParameterName": "GCloudRunDeploy.Container",
                "Purpose": ""
            }
        }
    ],
    "Properties": {
        "Octopus.Action.Script.ScriptSource": "Inline",
        "Octopus.Action.Script.Syntax": "Bash",
        "Octopus.Action.Script.ScriptBody": "account=$(get_octopusvariable \"GCloudRunDeploy.Account\")\nproject=$(get_octopusvariable \"GCloudRunDeploy.Project\")\nregion=$(get_octopusvariable \"GCloudRunDeploy.Region\")\n\nservice=$(get_octopusvariable \"GCloudRunDeploy.Service\")\nimage=$(get_octopusvariable \"Octopus.Action.Package[GCloudRunDeploy.Container].Image\")\nadditionalParams=$(get_octopusvariable \"GCloudRunDeploy.AdditionalParameters\")\nprintCommand=$(get_octopusvariable \"GCloudRunDeploy.PrintCommand\")\n\nif [ \"$account\" = \"\" ] ; then\n    fail_step \"'Account' is a required parameter for this step.\"\nfi\n\nif [ \"$project\" = \"\" ] ; then\n    fail_step \"'Project' is a required parameter for this step.\"\nfi\n\nif [ \"$region\" = \"\" ] ; then\n    fail_step \"'Region' is a required parameter for this step.\"\nfi\n\nif [ \"$service\" = \"\" ] ; then\n    fail_step \"'Service' is a required parameter for this step.\"\nfi\n\nif [ \"$printCommand\" = \"True\" ] ; then\n    set -x\nfi\n\ngcloud run deploy $service --image=$image ${additionalParams:+ $additionalParams}",
        "Octopus.Action.GoogleCloud.UseVMServiceAccount": "False",
        "Octopus.Action.GoogleCloudAccount.Variable": "#{GCloudRunDeploy.Account}",
        "Octopus.Action.GoogleCloud.ImpersonateServiceAccount": "False",
        "Octopus.Action.GoogleCloud.Project": "#{GCloudRunDeploy.Project}",
        "Octopus.Action.GoogleCloud.Region": "#{GCloudRunDeploy.Region}",
        "Octopus.Action.GoogleCloud.Zone": "#{GCloudRunDeploy.Zone}"
    },
    "Parameters": [
        {
            "Id": "cc0f6d96-8ae8-49c7-a98e-2c6ec49be818",
            "Name": "GCloudRunDeploy.Container",
            "Label": "Container",
            "HelpText": "The container to deploy to Cloud Run.\n\n**This step only uses the container image and tag to provide a Release specific value to pass to the `gcloud run deploy` command.** Please make sure that the chosen container is accessible by Google Cloud and the appropriate service accounts.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "Package"
            }
        },
        {
            "Id": "7225abe8-e8c0-4c70-b077-e0e603caf330",
            "Name": "GCloudRunDeploy.Account",
            "Label": "Account",
            "HelpText": "Google Cloud Account to use for the command.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "GoogleCloudAccount"
            }
        },
        {
            "Id": "7ae8e5b2-2792-415f-b53a-f38ee3a0d605",
            "Name": "GCloudRunDeploy.Project",
            "Label": "Project",
            "HelpText": "Google Cloud project to use with the command.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "54794e4f-8681-4198-8157-226909dce509",
            "Name": "GCloudRunDeploy.Region",
            "Label": "Region",
            "HelpText": "Google  Cloud region to use with the command. This is used by the underlying Octopus step and not passed to the `gcloud run deploy` command.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "56ae0926-0f3b-416d-beea-162a02f5f5c0",
            "Name": "GCloudRunDeploy.Zone",
            "Label": "Zone",
            "HelpText": "Google Cloud zone to use with the command.",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "f71d5a0e-215b-4eda-a70d-589313deadd5",
            "Name": "GCloudRunDeploy.Service",
            "Label": "Service",
            "HelpText": "ID of the service or fully qualified identifier for the service. To set the service attribute:\n\n* provide the argument SERVICE on the command line;\n* specify the service name from an interactive prompt.\n",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "7425e1db-79a5-4328-8d4b-5f9378e6539c",
            "Name": "GCloudRunDeploy.AdditionalParameters",
            "Label": "Additional Parameters",
            "HelpText": "Provide any additional parameters per [the documentation](https://cloud.google.com/sdk/gcloud/reference/run/deploy).\n\nExample: `--platform=managed --region=us-central1 --allow-unauthenticated`",
            "DefaultValue": "",
            "DisplaySettings": {
                "Octopus.ControlType": "SingleLineText"
            }
        },
        {
            "Id": "c20cdbad-f023-4a47-87a4-d17eee59c3c0",
            "Name": "GCloudRunDeploy.PrintCommand",
            "Label": "Print Command?",
            "HelpText": "Prints the command in the logs using set -x. This will cause a warning when the step runs.",
            "DefaultValue": "False",
            "DisplaySettings": {
                "Octopus.ControlType": "Checkbox"
            }
        }
    ],
    "StepPackageId": "Octopus.GoogleCloudScripting",
    "$Meta": {
        "ExportedAt": "2022-03-17T19:46:39.101Z",
        "OctopusVersion": "2022.2.387-hotfix.903",
        "Type": "ActionTemplate"
    },
    "LastModifiedBy": "ryanrousseau",
    "Category": "Google Cloud",
    "Logo": "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",
    "MinimumServerVersion": "2021.2.0"
}
